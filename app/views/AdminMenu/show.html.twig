{% extends 'app_admin_layout.html.twig' %}
{% block css %}
    <link href="/admin/assets/plugins/jquery-datatable/css/jquery.dataTables.css" rel="stylesheet" type="text/css">
    <link href="/admin/assets/plugins/datatables-responsive/css/datatables.responsive.css" rel="stylesheet" type="text/css" media="screen"/>
    <link href="/admin/assets/plugins/jquery-nestable/jquery.nestable.css" rel="stylesheet" type="text/css" media="screen">
{% endblock %}
{% block javascripts_footer %}
    <script src="/admin/assets/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
    <script src="/admin/assets/plugins/jquery-nestable/jquery.nestable.js" type="text/javascript"></script>
    <script src="/admin/assets/plugins/jquery-datatable/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="/admin/assets/plugins/jquery-datatable/extra/js/TableTools.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/admin/assets/plugins/datatables-responsive/js/datatables.responsive.js"></script>
    <script type="text/javascript" src="/admin/assets/plugins/datatables-responsive/js/lodash.min.js"></script>
    <script src="/js/menu/menus_validation.js" type="text/javascript"></script>
    <script src="/js/menu/menus_sortable.js" type="text/javascript"></script>
{% endblock %}
{% block breadcrumb %}
    Edit Menu
{% endblock %}
{% block back_to %}
    <div class="page-title"><a href="{{ path('menuList') }}"><i class="icon-custom-left"></i></a>

        <h3>Back to <span class="semi-bold">Menus</span></h3>
    </div>
{% endblock %}
{% block content_title %}
    Edit Menu
{% endblock %}
{% block body %}
    {% if flash %}
        <div class="alert">
            <button class="close" data-dismiss="alert"></button>
            {{ flash.message }}
        </div>
    {% endif %}
    <div class="col-lg-3 col-md-4">
        <form action="{{ path("menuEdit", menu.getId()) }}" method="POST" id="add_menu_form">
            {{ CSRFinput()|raw }}
            <div class="form-group">
                <label for="title">Menu name</label>
                <span class="help">e.g. "My new menu"</span>

                <div class="controls">
                    <input name="menu_name" type="text" placeholder="Menu name" value="{{ menu.getName() }}" id="menu_name" required/>
                </div>
            </div>
            <div class="form-group">
                <label for="menu_location">Menu Location</label>
                <span class="help">Select desired menu location</span>

                <div class="controls">
                    <select name="menu_location" type="text" placeholder="Menu Location" id="menu_location" required>
                        <option value="1" {% if menu.getLocation() == 1 %} selected {% endif %}>Header</option>
                        <option value="2" {% if menu.getLocation() == 2 %} selected {% endif %}>Footer</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <button class="btn btn-success btn-cons" type="submit">Save</button>
                <button class="btn btn-warning btn-cons" type="reset">Reset
                </button>
            </div>
        </form>
        <form action="{{ path('menuDelete', menu.getId() ) }}" method="post">
            {{ CSRFinput()|raw }}
            <input class="btn btn-danger btn-cons" type="submit" value="Delete">
        </form>
    </div>
    <div class="col-lg-3 col-md-4">
        <h4><i class="fa fa-sort"></i> Menu items</h4>
        <div class="row">
        {% if menu.getItems() is empty %}
            <div class="alert">
                <button data-dismiss="alert" class="close"></button>
                There is no menu items at this time, feel free to add how many items you like.
            </div>
        {% endif %}
        {% import "menu_macro.html.twig" as menuMacro %}
        <div class="dd" id="menu_items_list" data-urlpost="{{ path("menuUpdateItems", menu.getId()) }}">
            <ol class="dd-list dark" id="menu_items_list_container">
                {% for mainItem in menu.getItems() %}
                    <li class="dd-item" id="{{ mainItem.name }}" data-name="{{ mainItem.name }}" data-url="{{ mainItem.url }}">
                        <div class="dd-handle">{{mainItem.name}}</div>
                        {% if mainItem.children is defined %}
                            {{ menuMacro.children(mainItem.children) }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ol>
        </div>
        </div>
        <hr>
        <div class="row">
            <h4><i class="fa fa-trash-o"></i> Trash menu items</h4>
            <div class="dd" id="trash_menu_items">
                <ol class="dd-list dark">
                    <li class="dd-item">
                        <div class="dd-handle">Drag item here to remove from menu</div>
                    </li>
                </ol>
            </div>
        </div>
        <hr>
        <div class="row">
            <button type="button" class="btn btn-primary btn-cons" id="force_save_menu">Save</button>
        </div>
    </div>
    <div class="col-lg-3 col-md-4">
        {% if dependencies['Blog'] is defined %}
            <h4><i class="fa fa-tags"></i> Add item to menu from categories</h4>
            {% if dependencies['Blog'] is empty %}
                <div class="alert">
                    <button data-dismiss="alert" class="close"></button>
                    There is no categories yet, firstly add some categories and then come back here.
                </div>
            {% endif %}
            <table class="table table-hover table-condensed dataTable">
                <thead>
                    <tr>
                        <td>Category name</td>
                    </tr>
                </thead>
                <tbody>
                {% for category in dependencies['Blog'] %}
                    <tr class="item_transfer_to_menu" data-itemName="{{ category.getName() }}" data-composedUrl="{{ path("viewCategory", category.getName()) }}">
                        <td>{{ category.getName() }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        {% endif %}
    </div>
    <div class="col-lg-3 col-md-4">
        <h4><i class="fa fa-plus"></i> Add custom Url</h4>

        <form action="#">
            <div class="form-group">
                <label for="custom_menu_item_name">Menu item name</label>
                <span class="help">e.g "my new menu item"</span>

                <div class="controls">
                    <input name="custom_menu_item_name" type="text" placeholder="Menu item name" id="custom_menu_item_name" required/>
                </div>
            </div>
            <div class="form-group">
                <label for="custom_menu_item_url">Menu item custom url</label>
                <span class="help">e.g "http://something.com"</span>

                <div class="controls">
                    <input name="custom_menu_item_url" type="text" placeholder="Menu item url" id="custom_menu_item_url" required/>
                </div>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-primary btn-cons item_transfer_to_menu" id="custom_transfer_box">Add</button>
            </div>
        </form>
    </div>
{% endblock %}
